<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Run Scripts from chat-bubble</title>

    <!-- for mobile screens -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- stylesheets are conveniently separated into components -->
    <link rel="stylesheet" media="all" href="./node_modules/chat-bubble/component/styles/setup.css" />
    <link rel="stylesheet" media="all" href="./node_modules/chat-bubble/component/styles/says.css" />
    <link rel="stylesheet" media="all" href="./node_modules/chat-bubble/component/styles/reply.css" />
    <link rel="stylesheet" media="all" href="./node_modules/chat-bubble/component/styles/typing.css" />
    <link rel="stylesheet" media="all" href="./node_modules/chat-bubble/component/styles/input.css" />
    <style>
      body {
        background: #dcdde0;
      }
      .bubble-container {
        height: 100vh;
      }
      .bubble-container .input-wrap textarea {
        margin: 0;
        width: calc(100% - 30px);
      }
    </style>
  </head>
  <body>
    <!-- container element for chat window -->
    <div id="chat"></div>

    <!-- import the JavaScript file -->
    <script src="./node_modules/chat-bubble/component/Bubbles.js"></script>
    <script>
      // initialize by constructing a named function./node_modules/chat-bubble.
      var chatWindow = new Bubbles(
        document.getElementById("chat"), // ./node_modules/chat-bubble.passing HTML container element./node_modules/chat-bubble.
        "chatWindow" // ./node_modules/chat-bubble.and name of the function as a parameter
      );

    // Make a POST request to fetch the conversation flow from the API
        fetch('http://localhost:5000/app/start', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        }
        })
        .then(response => response.json())
        .then(data => {
            // Assign the conversation flow JSON to the convo variable
            console.log(data)
            var convo = data;

            // Proceed with your chatbot logic using the retrieved conversation flow
            // ...
            chatWindow.talk(convo);
        })
        .catch(error => {
            // Handle any errors that occur during the API request
            console.error('Error fetching conversation flow:', error);
        });

      // this function is called when user asks for banana
      var bananaFunction = function () {
        alert("üçå");
        console.log(convo)
        chatWindow.talk(convo, "ice"); // the conversation can be easily restarted from here.
      };
    </script>
  </body>
</html>